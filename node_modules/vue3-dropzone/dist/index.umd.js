!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("vue"),require("file-selector"),require("attr-accept")):"function"==typeof define&&define.amd?define(["exports","vue","file-selector","attr-accept"],n):n(((e="undefined"!=typeof globalThis?globalThis:e||self).bundle=e.bundle||{},e.bundle.umd=e.bundle.umd||{},e.bundle.umd.js={}),e.vue,e.fileSelector,e.accepts)}(this,(function(e,n,t,r){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=o(r),a=function(){return(a=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function u(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]])}return t}function l(e,n,t,r){return new(t||(t=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function u(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,u)}l((r=r.apply(e,n||[])).next())}))}function c(e,n){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function s(e,n){for(var t=0,r=n.length,o=e.length;t<r;t++,o++)e[o]=n[t];return e}function f(e){e.preventDefault()}function v(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,(function(e){return"Files"===e||"application/x-moz-file"===e})):!!e.target&&!!e.target.files}function p(e){return"function"==typeof e.isPropagationStopped?e.isPropagationStopped():void 0!==e.cancelBubble&&e.cancelBubble}var d={code:"too-many-files",message:"Too many files"},g=function(e){return e=Array.isArray(e)&&1===e.length?e[0]:e,{code:"file-invalid-type",message:"File type must be "+(Array.isArray(e)?"one of "+e.join(", "):e)}};function y(e){return null!=e}function D(e,n){var t="application/x-moz-file"===e.type||i.default(e,n);return[t,t?null:g(n)]}var m=function(e){return{code:"file-too-large",message:"File is larger than "+e+" bytes"}},b=function(e){return{code:"file-too-small",message:"File is smaller than "+e+" bytes"}};function h(e,n,t){if(y(e.size)&&e.size)if(y(n)&&y(t)){if(e.size>t)return[!1,m(t)];if(e.size<n)return[!1,b(n)]}else{if(y(n)&&e.size<n)return[!1,b(n)];if(y(t)&&e.size>t)return[!1,m(t)]}return[!0,null]}function F(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(n){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.some((function(e){return!p(n)&&e&&e.apply(void 0,s([n],t)),p(n)}))}}var w={disabled:!1,getFilesFromEvent:t.fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1};function E(e,n){switch(n.type){case"focus":return a(a({},e),{isFocused:!0});case"blur":return a(a({},e),{isFocused:!1});case"openDialog":return a(a({},e),{isFileDialogActive:!0});case"closeDialog":return a(a({},e),{isFileDialogActive:!1});case"setDraggedFiles":var t=n.isDragActive,r=n.draggedFiles;return a(a({},e),{draggedFiles:r,isDragActive:t});case"setFiles":return a(a({},e),{acceptedFiles:n.acceptedFiles,fileRejections:n.fileRejections});case"reset":return a(a({},e),{isFileDialogActive:!1,isDragActive:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]});default:return e}}e.useDropzone=function(e){void 0===e&&(e={});var t=n.ref(a(a({},w),e));n.watch((function(){return a({},e)}),(function(e){t.value=a(a({},t.value),e)}));var r=n.ref(),o=n.ref(),i=function(e,t,r){var o=n.reactive(t),i=function(t){var r=e(n.toRaw(o),t);Object.keys(r).forEach((function(e){o[e]=r[e]}))};return null!=r&&i(r),[o,i]}(E,{isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]}),g=i[0],y=i[1],m=function(){o.value&&(y({type:"openDialog"}),o.value.value="",o.value.click())},b=function(){var e=t.value.onFileDialogCancel;g.isFileDialogActive&&setTimeout((function(){if(o.value){var n=o.value.files;n&&!n.length&&(y({type:"closeDialog"}),"function"==typeof e&&e())}}),300)};function x(e){r.value&&((r.value.$el||r.value).isEqualNode(e.target)&&(32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),m())))}function O(){y({type:"focus"})}function j(){y({type:"blur"})}function A(){var e;t.value.noClick||(void 0===e&&(e=window.navigator.userAgent),function(e){return e.includes("MSIE")||e.includes("Trident/")}(e)||function(e){return e.includes("Edge/")}(e)?setTimeout(m,0):m())}var z=n.ref([]),S=function(e){r.value&&((r.value.$el||r.value).contains(e.target)||(e.preventDefault(),z.value=[]))};function k(e){t.value.noDragEventsBubbling&&e.stopPropagation()}function C(e){return l(this,void 0,void 0,(function(){var n,r,o,i,a;return c(this,(function(u){switch(u.label){case 0:return n=t.value,r=n.getFilesFromEvent,o=n.noDragEventsBubbling,i=n.onDragEnter,e.preventDefault(),k(e),z.value=s(s([],z.value),[e.target]),v(e)?r?[4,r(e)]:[2]:[3,2];case 1:if((a=u.sent())||(a=[]),p(e)&&!o)return[2];y({draggedFiles:a,isDragActive:!0,type:"setDraggedFiles"}),i&&i(e),u.label=2;case 2:return[2]}}))}))}function P(e){var n=t.value.onDragOver;if(e.preventDefault(),k(e),e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(e){}return v(e)&&n&&n(e),!1}function R(e){e.preventDefault(),k(e);var n=z.value.filter((function(e){return!!r.value&&(r.value.$el||r.value).contains(e)})),o=n.indexOf(e.target);if(-1!==o&&n.splice(o,1),z.value=n,!(n.length>0)){y({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]});var i=t.value.onDragLeave;v(e)&&i&&i(e)}}function T(e){e.preventDefault(),k(e),z.value=[];var n=t.value,r=n.getFilesFromEvent,o=n.noDragEventsBubbling,i=n.accept,a=n.minSize,u=n.maxSize,l=n.multiple,c=n.maxFiles,s=n.onDrop,f=n.onDropRejected,g=n.onDropAccepted;if(v(e)){if(!r)return;Promise.resolve(r(e)).then((function(n){if(!p(e)||o){var t=[],r=[];n.forEach((function(e){var n=D(e,i),o=n[0],l=n[1],c=h(e,a,u),s=c[0],f=c[1];if(o&&s)t.push(e);else{var v=[l,f].filter((function(e){return e}));r.push({file:e,errors:v})}})),(!l&&t.length>1||l&&c>=1&&t.length>c)&&(t.forEach((function(e){r.push({file:e,errors:[d]})})),t.splice(0)),y({acceptedFiles:t,fileRejections:r,type:"setFiles"}),s&&s(t,r,e),r.length>0&&f&&f(r,e),t.length>0&&g&&g(t,e)}}))}y({type:"reset"})}n.onMounted((function(){window.addEventListener("focus",b,!1),t.value.preventDropOnDocument&&(document.addEventListener("dragover",f,!1),document.addEventListener("drop",S,!1))})),n.onUnmounted((function(){window.removeEventListener("focus",b,!1),t.value.preventDropOnDocument&&(document.removeEventListener("dragover",f),document.removeEventListener("drop",S))}));var B=function(e){return t.value.disabled?void 0:e},L=function(e){return t.value.noKeyboard?void 0:B(e)},K=function(e){return t.value.noDrag?void 0:B(e)},I=function(e){e.stopPropagation()},q=n.computed((function(){return g.draggedFiles?g.draggedFiles.length:0})),M=n.computed((function(){return q.value>0&&function(e){var n=e.files,t=e.accept,r=e.minSize,o=e.maxSize,i=e.multiple,a=e.maxFiles;return!(!i&&n.length>1||i&&a>=1&&n.length>a)&&n.every((function(e){var n=D(e,t)[0],i=h(e,r,o)[0];return n&&i}))}({files:g.draggedFiles,accept:t.value.accept,minSize:t.value.minSize,maxSize:t.value.maxSize,multiple:t.value.multiple,maxFiles:t.value.maxFiles})})),$=n.computed((function(){return q.value>0&&!M.value}));return a(a({},n.toRefs(g)),{isDragAccept:M,isDragReject:$,isFocused:n.computed((function(){return g.isFocused&&!t.value.disabled})),getRootProps:function(e){void 0===e&&(e={});var n=e.onKeyDown,o=e.onFocus,i=e.onBlur,l=e.onClick,c=e.onDragEnter,s=e.onDragenter,f=e.onDragOver,v=e.onDragover,p=e.onDragLeave,d=e.onDragleave,g=e.onDrop,y=u(e,["onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragenter","onDragOver","onDragover","onDragLeave","onDragleave","onDrop"]);return a(a({onKeyDown:L(F(n,x)),onFocus:L(F(o,O)),onBlur:L(F(i,j)),onClick:B(F(l,A)),onDragenter:K(F(c,s,C)),onDragover:K(F(f,v,P)),onDragleave:K(F(p,d,R)),onDrop:K(F(g,T)),ref:r},t.value.disabled||t.value.noKeyboard?{}:{tabIndex:0}),y)},getInputProps:function(e){void 0===e&&(e={});var n=e.onChange,r=e.onClick,i=u(e,["onChange","onClick"]),l={accept:t.value.accept,multiple:t.value.multiple,style:"display: none",type:"file",onChange:B(F(n,T)),onClick:B(F(r,I)),autoComplete:"off",tabIndex:-1,ref:o};return a(a({},l),i)},rootRef:r,inputRef:o,open:B(m)})},Object.defineProperty(e,"__esModule",{value:!0})}));
